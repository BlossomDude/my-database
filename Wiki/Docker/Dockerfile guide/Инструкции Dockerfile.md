---
Owner: Blossom Dude
Last edited time: 2024-07-04T12:33
Created time: 2023-10-30T14:10
---

\
[
Полезная статья про CMD и ENTRYPOINT](https://habr.com/ru/companies/slurm/articles/329138/)

|                 |                                                                                                                                                                                                                                                                 |                                                                                                                                                             |
| --------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Инструкция**  | **Описание**                                                                                                                                                                                                                                                    | **Пример**                                                                                                                                                  |
| **ADD**         | Добавляет файлы/папки из текущего окружения в образ. Если в качестве копируемого файла указать архив, то он будет добавлен в образ в распакованном виде. Также в качестве источника принимает URL. **РЕКОМЕНДУЕТСЯ ДЛЯ АРХИВОВ, ДЛЯ ОСТАЛЬНОГО ИСПОЛЬЗУЙ COPY** | ADD /root/.ssh/{id_rsa,id_rsa.pub} /root/.ssh/  <br>  <br>  <br>==только в buildkit:==  <br>ADD --chown=user /app /appdir  <br>ADD --chmod=777 /app /appdir |
| **ARG**         | Создает переменную, которую может использовать сборщик.  <br>  <br>**Данная переменная не будет доступна в контейнере, только во время сборки!**                                                                                                                | ARG folder=/opt/appsWORKDIR $folder                                                                                                                         |
| **COPY**        | Также как и ADD добавляет файлы в образ, но обладает меньшими функциями — не принимает URL и не распаковывает архивы. Рекомендован для использования в случаях, где не требуются возможности ADD или когда нужно перенести архив, как архив.                    | COPY ./mypasswd /root/  <br>  <br>  <br>==только в buildkit:==  <br>COPY --chmod=777 /app /appdir  <br>COPY --chown=user /app /appdir                       |
| **CMD**         | это команда, которую можно передать при запуске контейнера.                                                                                                                                                                                                     | CMD ["openvpn"]                                                                                                                                             |
| **ENTRYPOINT**  | в отличие от CMD, неизменяемые при создании образа команды, которые можно заменить при запуске контейнера.                                                                                                                                                      | ENTRYPOINT ["/sbin/apache2"]                                                                                                                                |
| **ENV**         | Задает переменные окружения в образе.                                                                                                                                                                                                                           | ENV PGPASSWORD pass                                                                                                                                         |
| **EXPOSE**      | Указывает, какой порт должно использовать приложение внутри контейнера.                                                                                                                                                                                         | EXPOSE 8080                                                                                                                                                 |
| **MAINTAINER**  | Автор образа.                                                                                                                                                                                                                                                   | MAINTAINER DMosk <master@dmosk.ru>                                                                                                                          |
| **RUN**         | Выполняет команду в новом слое при построении образа.                                                                                                                                                                                                           | RUN apt-get install python                                                                                                                                  |
| **LABEL**       | Добавляет метаданные.                                                                                                                                                                                                                                           | LABEL version="2"                                                                                                                                           |
| **FROM**        | Указывает, какой базовый образ нужно использовать. Обязательная инструкция для Dockerfile                                                                                                                                                                       | FROM ubuntu:16.04                                                                                                                                           |
| **VOLUME**      | Добавляет том в контейнер.                                                                                                                                                                                                                                      | VOLUME ["/opt/myapp"]                                                                                                                                       |
| **USER**        | Задает пользователя, от которого будет запущен образ.                                                                                                                                                                                                           | USER user:group                                                                                                                                             |
| **ONBUILD**     | Действия, которые выполняются, если наш образ используется как базовый для другой сборки.                                                                                                                                                                       | ONBUILD ADD . /app/src                                                                                                                                      |
| **STOPSIGNAL**  | Переопределяет сигнал SIGTERM для завершения контейнера.                                                                                                                                                                                                        | STOPSIGNAL SIGINT                                                                                                                                           |
| **HEALTHCHECK** | Команда, которая будет проверять работоспособность контейнера.                                                                                                                                                                                                  | HEALTHCHECK --interval=5m --timeout=3s CMD curl -f http://localhost/ \| exit 1                                                                              |
| **SHELL**       | Позволяет заменить стандартную оболочку для выполнения команд на пользовательскую.                                                                                                                                                                              | SHELL ["/bin/bash", "-c"]                                                                                                                                   |
| **WORKDIR**     | Можно задать каталог **в контейнере**, откуда будут запускаться команды ENTRYPOINT и CMD.                                                                                                                                                                       | WORKDIR /opt/apps                                                                                                                                           |