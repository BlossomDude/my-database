
---
Deployment - объект k8s который создает оболочку для Pod's и Replics Set. Он нужен для того чтобы управлять несколькими подами как единым целым. 
- Он поддерживает rolling updates - поэтапное обновление подов.
- Имеет отличие от Replca Set тем что это более высокоуровневый объект. Он создает pod и rs, при указании колличества реплик.



---
##### Rolling updates & Rollback
---
Это стратегия обновления приложения, при которой Pods с новой версией постепенно заменяют Pods со старой версией. Эта стратегия позволяет обновлять приложение без простоев, обеспечивая его доступность на протяжении всего процесса.

Данная возможность доступна только для Deployment.

Существует две стратегии обновления приложения в deployment:
- `recreate` - удаление старых и поднятие обновленных версий приложения. Плохой вариант, так как в нем есть downtime. К счастью это стратегия не по умолчанию.
- `Rolling Update` - стратегия при которой поочередно поды завершаются и поднимаются с новой версией. Один под удаляется, один поднимается, один удаляется и так далее. Это обеспечивает непрерывную работу приложения в рабочем состоянии

Как работает Rolling update стратегия:
- При инициализации deployment, создается replica set.
- При изменении в нашем манифесте, создается новый replica set в котором поднимается по одному контейнеру. В свою очередь в старой replica set контейнеры по одному удаляются.
- Так происходит пока в первой rs не остановятся все контейнеры, а в новом rs не появится нужно кол-во реплик.

При возврате на предыдущую ревизию командой:
`kubectl rollout undo deployment/my-deploy`
Поды в текущем рабочем replica set останавливаются, а в старом rs поднимаются.

Для указании стратегии, необходимо указать тип:
```yaml
apiVersion: v1
kind: Deployment
...
spec:
  strategy:
    type: Recreate
```