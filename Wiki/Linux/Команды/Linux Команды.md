---
Owner: Blossom Dude
Last edited time: 2024-05-28T20:14
Created time: 2023-07-04T14:13
---
-  [[#Без тега]]
- [[#Links]]
- [[#Текст]]
- [[#Железо, аппаратная часть]]
- [[#Пакетные менеджеры]]
- [[#SystemD]]
	- [[#Systemctl|Systemctl]]
	- [[#Target|Target]]
	- [[#Unit|Unit]]
	- [[#Journalctl|Journalctl]]
- [[#Сеть]]
- [[#SSH]]
- [[#Backup]]
- [[#Man]]
- [[#Права]]
- [[#Процессы]]
- [[#SSL TLS]]

# Без тега


`du`
	`-sh <file>` - Посмотреть размер файла

`iptables`
	`-L` - Список текущих правил
	`-A INPUT` - Добавить правило 
	`-I OUTPUT` - Добавить правило в начало списка правил
	`-D OUTPUT 5` - Удалить (пятое output) правило
	`-p tcp` - Протокол
	`-s` - source
	`-d` - destination
	`-dport 22` - dectination port 
	`-j ACCEPT` - какое выполнить действие

`useradd username` - Создание пользователя
	`-с` - Добавить комментарий
	`-d` - Указать домашний каталог
	`-e` - Дата истечения срока УЗ
	`-g` - Указать GID группы
	`-G` - добавить несколько групп
	`-s` - пользовательский логин оболочки
	`-u` - пользовательский UID
`userdel username` - удалить пользователя

`usermod` - команда для управления пользователями
	`-l <new> <old_login>` - поменять логин пользователя
	`-s /bin/shell` - поменять оболочку пользователя   
	`--lock` - отключить учетную запись
		`--unlock`
	`-e <01.01.2030>` - установить срок службы учетной записи
`pvcreate /dev/sda` - создать физический том
`pvdisplay` - показать физический том
`vgcreate name_vg /dev/sda /dev/sdb...`  - создать группу томов
`vgdisplay` - показать подробности групп томов
`lvcreate -L 1G -n vol1 name_vg` - Создать линейный LVM с 1Гб объемом и именем name_vg 
`lvresize -L +1G -n /dev/name_vg/vol1` - добавить 1Гб к созданному ранее LVM
`lvdisplay` - показать LVM

`resize2fs /dev/name_vg/vol1` - Расшить файловую систему 

`id username` - Посмотреть имя пользователя, его группы , UID, GID

`find <dir>`
	`-name '*.yaml` - найти файл по шаблону
		`-iname`  - для того чтобы игнорировать регистр
	`-mmin -1` - файлы которые были изменены за последнюю минуту.
	`-mtime 1` - файлы которые были изменены в последние 12 часа
	`-cmin` and `-ctime` - файлы состояние(права, разрешения) которых изменилось 
	`-size +10M` - найти файлы размером больше 10мб 
	`-perm 644` - искать файлы по разрешениям
		`-644` - при указании дефиса, будет вывод файлов у которых есть данные права и более. т.е. 664 или 644 и тд
		`/644` - будет искать все права кроме этих
	`-o` - логическое OR
		`-name A -o -name B` - выведет файлы с названием A или B 
	`-not` - отрицание
		`-not -name A` - выведет все файлы кроме файлов А
	

`shutdown` 
	`15:00` - выключит систему в определенное время. 24-часовой формат
	`+15` - выполнить команду через 15 минут.
	`-c` - отменить запланированное выключение
	`-r` - перезагрузить систему. Так же можно назначить время
	`'Message'` - добавить сообщение, чтобы предупредить других пользователей
`tar`
	`-cf <tar_name.tar file1 file2...>`  - Создать тар-архив
	`-C </tmp/>` - куда положить распакованный или запакованный файл
	`-P </some_dir>` - создать tar из всего содержимого дериктории 
	`-tf <tar_name.tar>` - Посмотреть содержимое тар-архива
	`-xf <tar_name.tar>` - Распаковать тар-архив
	`-zcf <tar_name.tar file1 file2...>` -  Сжать в тар-архив
	
`bzip2 <file.txt>` - Сжать в bzip2
	`bunzip2 <file.txt>` - Разархивировать
	`bzcat <file.txt.bz2>` - Посмотреть содержимое без разархивации(bz/zip)
`gzip <file.txt>` - Сжать в gzip
	`gunzip2 <file.txt>` - Разархивировать
	`zcat <file.txt.gz>` - Посмотреть содержимое без разархивации
`xz <file.txt>` Сжать в xz
	`unxz <file.txt>` - Разархивировать
	`xzcat <file.txt.xz>` - Посмотреть содержимое без разархивации
`zip <archive_name> <some_file>` - создать архив archive_name из файла в формате zip.
	`-r` - рекурсивно создать архив из директории и его содержимого.
	`unzip` - извлечь архив




`stat some_file` -  команда для вывода метаданных файлов
	`stat --printf "File %n has been modified %y\n" /etc/passwd /etc/group` - выведет информацию о файле. 

`locate file.txt` - выполняет поиск файла в БД mlocate.db

`updatedb` - Обновит базу данных mlocate.db

`grep`
	`-i` - игнорировать регистр
	`-r` - искать рекурсивно в подкаталогах
	`-v` - выведет все строчки в которых нет заданного паттерна
	`-w` - выведет только точные совпадения а не вхождения слов
	`-o` - вывести только совпадение, без всей остальной строки.
	`-A3` - вывести три строки после нахождения
	`-B2` - вывести две строчки перед нахождением слова
	`-E` - включить расширенный regex
		`egrep` - либо можно использовать эту команду


tee
	`echo "text" | tee text.txt` - перенаправляет вывод в файл
	`echo "text" | tee -a text.txt` - запишет поверх уже имеющегося текста

| Команда                    | Описание                                                            | Примечание                                                                                |
| -------------------------- | ------------------------------------------------------------------- | ----------------------------------------------------------------------------------------- |
| `blkid`                    | Выводит UUID диска\флешки\носителя.                                 |                                                                                           |
| `update-alternatives`      | Поможет установить определенную версию программы по умолчанию.      |                                                                                           |
| `**nproc**`                | Показывает количество процессоров                                   |                                                                                           |
|                            |                                                                     |                                                                                           |
| `service status “service”` | Управление сервисами от [[Системы инициализации Linux]]             |                                                                                           |
| `trap`                     | при возникновении сигнала будет выполнено указанное действие.       | `trap -l` - список всех сигналов                                                          |
| `sysctl`                   | Команда для настройки и изменения параметров ядра.                  |                                                                                           |
| `nice -5 ./script.sh`      | Команда которое ставит приоритет процессорного времени              | `renice -10 *PID/user*` - для изменения параметра работающего процесса. или пользователя. |
| `set`                      | Изменение параметров, атрибутов оболочки                            | `set -x` включить отладку скрипта                                                         |
|                            |                                                                     | [[stat. форматирование вывода]]                                                           |
| `strace`                   | Утилита для отслеживания [[Системные вызовы]]                       |                                                                                           |

---
# Links

`ln some_file hard_link_to_file` - Создает жесткую ссылку
	`ln -s some_file soft_link_to_file` - создает мягкую ссылку
`readlink soft_link.txt` - выведет путь на который указывает ссылка.

---
# Текст
> [!important] 
> Подробнее - [[sed]]

|         |                                               |                                        |
| ------- | --------------------------------------------- | -------------------------------------- |
| `awk`   | Инструмент для обработки и фильтрации текста. | `**$ awk опции 'условие {действие}'**` |
| `cut`   |                                               |                                        |
| `fold`  |                                               |                                        |
| `head\  |                                               |                                        |
| `grep`  |                                               |                                        |
| `paste` |                                               |                                        |
| `sort`  |                                               |                                        |
|         |                                               |                                        |
| `tr`    |                                               |                                        |
| `uniq`  |                                               |                                        |
| `wc`    | Анализ файла. Подсчет строк, слов, символов   |                                        |
`compare some_file1 some_file2` - сравнить два файла.
`diff some_file1 some_file2` - сравнить два файла. (более удобная команда)

`tail` - команда для отображения последних строк файла
	`-F` - выводить файл в реальном времени

`sed` - потоковый редактор текста
	`sed '/template/d' text.txt` - удалит все строки с template
	`sed 's/\bold\b/new/g' test.txt` - заменит слова. \b показывает границу слов, чтобы не заменять такие слова как `older`, `oldy` и тд
	`-i` - отредактировать файл, а не вывести результат

`cut [options] [some_file] ` - команда для работы с текстом
	`-d ' '` - delimiter. выберет в качестве разделителя пробел
	`-f 1 ` - field. выведет первое слово в каждой строке 

`uniq` - удаление не уникальных слов.
	Команда не будет работать корректно если использовать ее без `sort`
		`sort some_file | uniq` - корректная команда для вывода уникальных слов.
`sort` - сортировка в файле
# Железо, аппаратная часть

> [!important] 
> [[Монтирование]]
> [[Load Average]]
> [[Namespaces]]

`gdisk` - программа для работы с дисками и разделами

|           |                                               |     |
| --------- | --------------------------------------------- | --- |
| `udevadm` | Запрос в базу данных udev                     |     |
| `dmesg`   | Логи ядра                                     |     |
| `lspci`   | Информация о PCI-шинах и устройствах на них   |     |
| `lsblk`   | Информация о дисках и устройствах             |     |
| `lscpu`   | Информация о процессоре                       |     |
| `free`    | Статистика используемой и свободной ОЗУ       |     |
| `lshw`    | Детальная информация о компонентах компьютера |     |

# Пакетные менеджеры

apk
```bash
apk add *pkg_name* #установить пакет их реп
apk del *pkg_name* #удалить пакет
apk upgrade #Обновление всех пакетов и их установка
apk serach *pkg_name* #поиск
apk cache clean #очистка кэша 

```

apt
```bash
apt purge Удаляет приложение и полностью все настройки 
apt update #Обновить репозиторий
apt upgrade #Обновить пакеты
apt edit-sources #редактировать список репозиториев
apt search #Искать пакет в репозитории
apt list #Вывод всех доступных пакетов
```
dpkg
```bash
dpkg -i #Установить пакет
dpkg -r #Удалить пакет
dpkg -l #Описание пакета
dpkg -s #Статус пакета
dpkg -p <path-to-file> #Подробное описание пакета
```

dnf
`dnf --showduplicates list *pkg_name*`  Посмотреть список доступных пакетов.

rpm
``` bash
rpm -qa #Вывести все пакеты. 
rpm -e *pkg_name* #Удалить пакет
rpm -ivh  #установить пакет
rpm -Uvh #обноваить
rpm -q #информация о пакете
rpm -Vf #верификация пакета
```
yum
``` bash
yum repolist # посмотреть все добавленные репозитории
yum provides # информация о пакете
yum remove # удалить пакет
yum update # обновить пакеты или один пакет
```

# SystemD
> [!important] 
> Подробнее про systemd:
> - [[SystemD]]
> - [[Targets SystemD]]
> - [[Unit-файлы SystemD]]
>   
[[Системы инициализации Linux]]



##### Systemctl

| `systemctl isolate target_name.target` | Перейти в таргет target_name                                          |
| -------------------------------------- | --------------------------------------------------------------------- |
| `systemctl list-units --all`           | Показывает весь список управляемых юнитов которые загружены в память. |
| `systemctl daemon-reload`              | Обновит конфигурацию systemctl, применяем после создания юнита        |
| `systemctl enable` `_*demon*_`         | Включить автозагрузку сервиса (disable-выключить)                     |
| `systemctl daemon-reload`              | Прикажет systemd прочитать заново unit-файлы и определить новые       |

`systemctl list-units --all` - Показывает весь список юнитов systemd
	`--type service` - выводит список сервисов. 
		Список типов сервисов: `automount/device/mount/path/scope/service/slice/socket/swap/target/timer`

`systemctl mask <service>` - маскировать сервис. После этого он не сможет быть запущен никаким образом.
`systemctl unmask <service>` - размаскировать сервис.
##### Target
`systemctl set-default -f <target>` - Установить таргет по умолчанию.
`systemct get-default` - Вывести текущий таргет
`systemctl isolate target_name.target` - Перейти в таргет target_name
##### Unit
`systemctl cat <service>` - вывести unit-файл сервиса 
`systemctl daemon-reload` - Обновить конфигурации unit-файлов
`systemctl edit --full <service>` - отредактировать unit-файл
`systemctl revert <service>` - вернуть unit-файл  к пред. состоянию

##### Journalctl
`journalctl` - получить все логи
	`-b` - логи текущего сеанса (boot'a) (0). Предыдущая загрузка -1 и т.д.
	`-e` - end - перейти к началу логов
	`-f` - follow. Выводить логи в реальном времени
	`-g <'^example'>` - grep - отфильтровать логи regex'ом
	`-p <err>` - priority - приоритет логов
		`err alert crit debug emerg info notice warning`
	`-S <21:00>` - since - смотреть логи начиная с этого времени 
	`-U <'2024.01.01 22:00:10'>` - until - смотреть логи до этого времени
	`-u name.service` - логи сервиса 
	`usr/bin/<bin>` - вывести логи сгенерированные только данным приложением

`systemd-cat` - Принимает строку на вход и отправляет лог в журнал systemd.
	`-t <service>` - Добавляет идентификатор к записи.
	`-p info` -  вешает "тег" на запись. `info` / `err`


---
# Сеть
> [!important] 
> [[Network]]

`firewall-cmd --permanent --zone=public --add-port=3000/tcp`
	`firewall-cmd --permanent --add-service=http` - разрешить http
`ip route add 1.1.1.1 via 2.2.2.2` - Прописать маршрут до 1 через 2 
`ip route add default via 1.1.1.1` - Добавить шлюз со значением 1   
`nethogs` - выводит программы по списку, от наиболее затратных до наименее.


---
# SSH
> [!important] 

`ssh`
	`-p 5022` - использовать специфичный порт
`ssh-copy-id user@server` - Скопировать ключ на сервер
`ssh-keygen` - создать пару ключей
	`-i path\to\file` - путь до ключа
	`-t ed25519` -  выбрать тип шифрования
`scp /src user@server:/dest` - копирует файл на удаленный сервер


---
# Backup
> [!important] 

`dd` - команда для создания бэкапа диска или раздела.
	`dd <if=/some_sda of=some_image.raw bs=1M status=progress`
		Команда создаст из диска снимок с расширением .raw, блок информации будет равен 1Мб и команда будет выводить статус операций благодаря последней опции. 
		Для восстановления образа диска надо поменять `if` и `of` местами.

`rsync` - команда для синхронизации данных между двумя серверами.
	`rsync -a <local_dir> <user@1.2.3.4 /remote_dir>`
		Синхронизировать свою локальную с удаленной директорией, сделать бэкап локальной директории. Работает в обе стороны.


---
# Man

> [!important] 

Если ты хочешь получить мануал по команде то тебе стоит вводить команду:
`man 1 printf`, так как существует функция с таким же названием.
```
       1   Executable programs or shell commands
       2   System calls (functions provided by the kernel)
       3   Library calls (functions within program libraries)
       4   Special files (usually found in /dev)
       5   File formats and conventions, e.g. /etc/passwd
       6   Games
       7   Miscellaneous (including macro packages and conventions),
            e.g. man(7), groff(7), man-pages(7)
       8   System administration commands (usually only for root)
       9   Kernel routines [Non standard]
```

`man man` - мануал по man
`mandb` - Обновляет базу данных man
`apropos` - команда для поиска утилит по описанию. 
	`apropos create file` -> `touch`
	`-s 1,2,4` -  искать в  определенных разделах


 
---
# Права

> [!important] 
> Подробнее про:
> [[SUID, GUID, Sticky Bit]]
> [[Лимиты для пользователей]]

`chgrp -R <group> <some_dir/>` - Поменять группу директории
`chown <user> <some_file>` - Поменять владельца файла

`groupadd -g 1011 groupname` - создать группу и выбрать GID 1011.
`groupdel groupname` - удалить группу

`chmod <rights> <some_file>`  - Поменять права у файла
	`u/g/o+r/w/x` - добавить права user, group, other + read, write, execute
	`u/g/o-r/w/x` - убрать права
	`u/g/o=r/w/x` - привести к данному выражению
	`777` - числовой формат. 4-r, 2-w,1-x.
	`+t` - Добавит Sticky Bit 
	`1744` - 1 Добавит Sticky Bit 
	`2744` - 2 - Добавит SGID
	`4744` - 4 - Добавит SUID
	`6744` - 6 - Добавит SGID и GUID

---
# Процессы

> [!important] 
Подробнее про:
 [[Сигналы]]
[[Порождение процессов Linux]]
Команду [[ps]]

`bg` - возобновить фоновый процесс если он остановлен
`fg` - открыть фоновый процесс

`lsof <file>` - Утилита, отображающая какими файлами пользуются разные процессы.
	`-p <pid>` - указать pid 

`nice -n 1 bash` - назначить nice
	^`renice 19 <pid>` - переназначить nice

`kill` - команда для отправки сигналов
	`-l` - выводит список всех сигналов и их номер
	`-<signal> <pid>` - отправит сигнал процессу по его PID
	^`pkill` - то же что и kill, только позволит указывать имя вместо pid

`jobs` - посмотреть ваши фоновые процессы 

`ps` - команда для вывода списка процессов
	`1` - вывести процесс по его PID. 
	`-a` - показать все процессы пользователя
	`-f` - forest - вывод в виде дерева
	`-u` - пользовательский формат. Доп. колонки (cpu, user etc)
	`-U <user>` - процессы определенного пользователя
	`-x` - показать все процессы у которых нет управляющего терминала.
	`-l` - long. 

`pgrep <process_name>` - process grep. Команда для поиска процессов.
	-a - all


---
# SSL TLS

> [!important]
> Подробнее про:
> [[SSL&TLS]] 
> 

`openssl` - стандартная утилита для работы с сертификатами
	`req` - создать запрос на подпись сертификата.
	Примеры:
		`openssl req -newkey rsa:2048 -keyout key.pem -out req.pem` -
			Данная команда создаст приватный ключ и запрос на подпись:
			`-newkey` - указывает тип шифрования
			`-keyout` - указывает название приватного ключа
			`-out` - сохраняет наш запрос на подпись в файл.
		`openssl req -x509 -noenc -newkey rsa:4096 -days 365 -keyout private.pem -out cert.crt`
			Команда создаст самоподписной сертификат x509 
			`-x509` - сгенерирует сертификат, вместо создания запроса на подпись
			`-noenc` - не запрашивать пароль шифрования для этого ключа (не рек.)   
			`-days 365` - количество дней которых будет действовать сертификат
	`x509` - команда для взаимодействия с сертификатами x509
	Примеры:
		`openssl x509 -in cert.crt -text` - выведет сертификат и метаданные 


---